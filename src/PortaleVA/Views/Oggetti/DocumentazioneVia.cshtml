@model VAPortale.Models.OggettiDocumentazioneViaModel
@{
    ViewBag.Title = string.Format("{0} - {1}", Model.Oggetto.GetNome(), Model.VoceMenu.GetNome());
    Layout = "~/Views/Shared/_LayoutInternoLargo.cshtml";
}
<div class="documentazione">
    <h2>@Model.Oggetto.GetNome()</h2>
    @*
<!-- Nav tabs -->
<ul class="nav nav-tabs tabProgetto">
    <li><a href="@Url.VAOggettoInfo(Model.Oggetto.ID)" title="@string.Format(DizionarioService.OGGETTO_LabelTabInfo, Model.Oggetto.TipoOggetto.GetNome())"
        class="infoProgettoTab">@string.Format(DizionarioService.OGGETTO_LabelTabInfo, Model.Oggetto.TipoOggetto.GetNome())</a></li>
    <li class="active"><a class="documentazioneTab" title="@DizionarioService.OGGETTO_LabelTabDocumentazione">
        @DizionarioService.OGGETTO_LabelTabDocumentazione</a></li>
</ul>
*@
    <div class="tableProcedura">
        <div class="pulsantiDocumentazione">
            <div class="pulsanteProcedura">
                <a title="Dettagli procedura" data-toggle="modal" data-target=".datiAmministrativi" href="#collapse">Dettagli procedura</a></div>
            <div class="pulsanteInfo">
                <a href="#" title="INFO Progetto e procedure">INFO Progetto e procedure</a></div>
        </div>
        <div class="modal fade datiAmministrativi" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-lg">
                <div class="modal-content">
                    <div class="table-restable">
                        <table width="" class="table">
                            <tr class="titoloTabellaModale">
                                <td colspan="2">
                                    <span class="titoloModale">Valutazione Impatto Ambientale (Legge Obiettivo 443/2001)</span>
                                    <span class="testataModalePulsanti">
                                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                            <span aria-hidden="true">&times;</span></button>
                                    </span>
                                </td>
                            </tr>
                            <tr>
                                <td style="width: 50%;">
                                    <strong>Codice procedura (ID_VIP):</strong>
                                </td>
                                <td>
                                    647
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <strong>Data presentazione istanza:</strong>
                                </td>
                                <td>
                                    05/02/2004
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <strong>Data pubblicazione avviso sui quotidiani:</strong>
                                </td>
                                <td>
                                    04/02/2004
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <strong>Termine presentazione Osservazioni del Pubblico:</strong>
                                </td>
                                <td>
                                    05/03/2004
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <strong>Data avvio istruttoria tecnica:</strong>
                                </td>
                                <td>
                                    21/04/2004
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <strong>Data ripubblicazione avviso sui quotidiani:</strong>
                                </td>
                                <td>
                                    03/12/2004
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <strong>Termine presentazione Osservazioni del Pubblico sul progetto ripubblicato:</strong>
                                </td>
                                <td>
                                    02/01/2005
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <strong>Oggetto ripubblicazione:</strong>
                                </td>
                                <td>
                                    Integrazioni e modifiche: Tratta B1 (ex B) e tratta B2 nuova
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <strong>Data Parere Commissione VIA Speciale:</strong>
                                </td>
                                <td>
                                    08/03/2005
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <strong>Esito Parere Commissione VIA Speciale:</strong>
                                </td>
                                <td>
                                    Positivo con prescrizioni
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <strong>Data trasmissione Parere al Ministro delle Infrastrutture e dei Trasporti:</strong>
                                </td>
                                <td>
                                    06/05/2005
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <strong>Data Delibera CIPE:</strong>
                                </td>
                                <td>
                                    29/03/2006
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <strong>N&#176; Delibera CIPE:</strong>
                                </td>
                                <td>
                                    77
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <strong>Esito Delibera CIPE:</strong>
                                </td>
                                <td>
                                    Positivo con prescrizioni
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <strong>Data pubblicazione Delibera CIPE su G.U.R.I.:</strong>
                                </td>
                                <td>
                                    23/11/2006
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <strong>N&#176; della Gazzetta Ufficiale della Repubblica Italiana:</strong>
                                </td>
                                <td>
                                    219
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <strong>Stato procedura:</strong>
                                </td>
                                <td>
                                    Conclusa
                                </td>
                            </tr>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Tab content -->
    @*<div class="tab-content">*@
    <h3>@DizionarioService.OGGETTO_TitoloScegliProcedura</h3>
    <div class="table-responsive">
        <table class="table">
            <tr>
                <th>@DizionarioService.GRIGLIA_ColonnaProcedura
                </th>
                <th>@DizionarioService.GRIGLIA_ColonnaDataAvvio
                </th>
                <th>@DizionarioService.GRIGLIA_ColonnaStatoProcedura
                </th>
            </tr>
            @foreach (ProceduraCollegata pc in Model.ProcedureCollegate)
            {
                string cssClass = "";
                if (pc.OggettoProceduraID == Model.OggettoProceduraID)
                {
                    cssClass = "success";
                }
                <tr class="@cssClass">
                    <td>
                        <strong><a href="@Url.Action("Documentazione", new { id = Model.Oggetto.ID, oggettoProceduraID = pc.OggettoProceduraID })">@pc.Procedura.GetNome()</a></strong>
                    </td>
                    <td>@pc.Data.Value.ToString(CultureHelper.GetDateFormat())
                    </td>
                    <td>@pc.StatoProceduraVIPERA.GetNome()
                    </td>
                </tr>
            }
        </table>
    </div>
    @if (Model.OggettoProceduraID > 0)
    {
        if (Model.Oggetto.ProcedureCollegate.First(x => x.OggettoProceduraID == Model.OggettoProceduraID).NumeroDocumenti > 0)
        {
        <div class="ricerca">
            <form method="get" id="form-cercaDocumentazione" action="@Url.ActionWithFragment("Documentazione", new { id = Model.ID, oggettoProceduraID = Model.OggettoProceduraID }, "form-cercaDocumentazione")">
            <div>
                <label for="Testo">@DizionarioService.RICERCA_LabelTesto</label>
                @Html.TextBoxFor(m => m.Testo)
                @Html.HiddenFor(m => m.RaggruppamentoID, new { id = "hidden-raggruppamentoid" })
                <input type="submit" value="@DizionarioService.RICERCA_BottoneEsegui" class="btn" />
            </div>
            </form>
        </div>
        <!-- Documentazione -->
        <h3>@DizionarioService.OGGETTO_TitoloDocumentazione</h3>
            { Html.RenderAction("RaggruppamentiRootNodes", "Oggetti", new { oggettoProceduraID = Model.OggettoProceduraID, raggruppamentoID = Model.RaggruppamentoID }); }
        <script type="text/javascript">
            $(".leaf").click(function () {
                var raggruppamentoID = $(this).data("raggruppamentoid");

                $("#hidden-raggruppamentoid").val(raggruppamentoID);
                $("#form-cercaDocumentazione").submit();
                return false;
            });
        </script>
        <!-- Risultati documenti -->
        <h3 class="risultati">
            @string.Format("(n.{0})", Model.TotaleRisultati) @string.Format(DizionarioService.RICERCA_TitoloRisultatiDocumentazione, Model.ProceduraSelezionata.Procedura.GetNome(), Model.ProceduraSelezionata.DataInserimento.ToString(CultureHelper.GetDateFormat()))</h3>
        <div class="table-responsive">
            <table class="table">
                <tr>
                    @*<th>
                        <input type="checkbox" />
                    </th>*@
                    <th>
                        <span class="hidden">@DizionarioService.TOOLTIP_Metadato</span>
                    </th>
                    <th>
                        <span class="hidden">download</span>
                    </th>
                    <th>@DizionarioService.GRIGLIA_ColonnaTitolo@*<input class="pull-right" type="image" name="freccia ordinamento" title="Non ordinato - clicca per ordinare"
                            src="css/img/frecce-ordinamento.png">*@
                    </th>
                    <th>
                        @DizionarioService.GRIGLIA_ColonnaSezione@*<input class="pull-right" type="image" name="freccia ordinamento su" title="Ordinato A-Z"
                            src="css/img/frecce-ordinamento-su.png">*@
                    </th>
                    <th>
                        @DizionarioService.GRIGLIA_ColonnaCodiceElaborato@*<input class="pull-right" type="image" name="freccia ordinamento giu"
                            title="Ordinato Z-A" src="css/img/frecce-ordinamento-giu.png">*@
                    </th>
                    <th>
                        @DizionarioService.GRIGLIA_ColonnaData@*<input class="pull-right" type="image" name="freccia ordinamento" title="Non ordinato - clicca per ordinare"
                            src="css/img/frecce-ordinamento.png">*@
                    </th>
                    <th>
                        @DizionarioService.GRIGLIA_ColonnaScala
                    </th>
                    <th>
                        @DizionarioService.GRIGLIA_ColonnaDimensione@*<input class="pull-right" type="image" name="freccia ordinamento" title="Non ordinato - clicca per ordinare"
                            src="css/img/frecce-ordinamento.png">*@
                    </th>
                </tr>
                @foreach (DocumentoElenco d in Model.Documenti)
                {
                    <tr>
                        @*<td>
                            <input type="checkbox" />
                        </td>*@
                        <td>
                            <a href="@Url.Action("MetadatoDocumento", new { id = d.ID })" class="icona-metadato" title="@DizionarioService.TOOLTIP_Metadato">@DizionarioService.TOOLTIP_Metadato</a>
                        </td>
                        <td>
                            <a href="@Url.VADocumentoViaVas(d.ID)" title="Download @d.Titolo" class="bt icona-@d.TipoFile.Estensione">
                                Download
                                @d.TipoFile.Estensione</a>
                        </td>
                        <td>@d.Titolo
                        </td>
                        <td>@d.Raggruppamento.GetNome()
                        </td>
                        <td>@d.CodiceElaborato
                        </td>
                        <td>@d.Data.ToString(CultureHelper.GetDateFormat())
                        </td>
                        <td>@d.Scala
                        </td>
                        <td>@string.Format("{0} kB", d.Dimensione)
                        </td>
                    </tr>
                }
            </table>
        </div>
        @Html.VaPaginatore(Model.Pagina, Model.DimensionePagina, Model.TotaleRisultati, "pagina", "form-cercaDocumentazione", x => Url.Action("Documentazione", x))
        <hr />
        <div class="buttonBackground">
            @Html.VaEsporta(x => Url.Action("Documentazione", x))
        </div>
        }
        else
        {
        <p>@DizionarioService.OGGETTO_TestoDocumentazioneNonDisponibile</p>
        }
    }
@*</div>*@
</div>
